<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Note26 â€” All-in-One Productivity Suite</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --primary-light: #a5b4fc;
            --secondary: #0f172a;
            --accent: #f59e0b;
            --accent-secondary: #ec4899;
            --bg: #fafbfc;
            --bg-secondary: #f1f5f9;
            --card-bg: #ffffff;
            --text: #0f172a;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --radius: 20px;
            --radius-sm: 12px;
            --shadow: 0 2px 8px rgba(15, 23, 42, 0.04), 0 1px 3px rgba(15, 23, 42, 0.08);
            --shadow-md: 0 8px 16px rgba(15, 23, 42, 0.08), 0 3px 6px rgba(15, 23, 42, 0.12);
            --shadow-lg: 0 24px 48px rgba(15, 23, 42, 0.12), 0 12px 24px rgba(15, 23, 42, 0.08);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.dark-theme {
            --bg: #0a0f1e;
            --bg-secondary: #1a1f35;
            --card-bg: #1a1f35;
            --text: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border: #2d3548;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden;
        }

        .app {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 100vh;
        }

        .app.home-view {
            grid-template-columns: 1fr;
        }

        /* Sidebar */
        .sidebar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: float 20s linear infinite;
            pointer-events: none;
        }

        @keyframes float {
            0% {
                transform: translate(0, 0);
            }

            100% {
                transform: translate(50px, 50px);
            }
        }

        .sidebar-header {
            text-align: center;
            color: white;
            position: relative;
            z-index: 1;
        }

        .sidebar-title {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            letter-spacing: -0.02em;
        }

        .sidebar-subtitle {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .sidebar-nav {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .nav-item {
            padding: 0.875rem 1.125rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            color: white;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(4px);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        .sidebar-footer {
            margin-top: auto;
            padding-top: 1.5rem;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            position: relative;
            z-index: 1;
            line-height: 1.6;
        }

        /* Main Content */
        .main-content {
            background: var(--bg);
            overflow-y: auto;
        }

        /* Home Page */
        .home-page {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .home-header {
            margin-bottom: 3rem;
        }

        .home-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .home-subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
        }

        .home-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 3rem;
        }

        .quick-action-card {
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .quick-action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .quick-action-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .quick-action-card:hover::before {
            transform: scaleX(1);
        }

        .quick-action-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            color: white;
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .quick-action-title {
            font-weight: 700;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .quick-action-desc {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .project-card {
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            opacity: 0;
            transition: var(--transition);
        }

        .project-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .project-card:hover::before {
            opacity: 1;
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .project-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .project-actions {
            display: flex;
            gap: 0.25rem;
        }

        .project-title {
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .project-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .project-stats {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: var(--card-bg);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            background: var(--bg-secondary);
        }

        .btn-icon {
            padding: 0.5rem;
            min-width: 36px;
            aspect-ratio: 1;
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            background: var(--bg-secondary);
            color: var(--text);
        }

        /* Workspace View */
        .workspace {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .workspace-header {
            background: var(--card-bg);
            border-bottom: 2px solid var(--border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .workspace-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .project-name-input {
            font-size: 1.5rem;
            font-weight: 700;
            background: transparent;
            border: 2px solid transparent;
            padding: 0.5rem;
            border-radius: var(--radius-sm);
            color: var(--text);
            outline: none;
            transition: var(--transition);
        }

        .project-name-input:hover {
            background: var(--bg);
        }

        .project-name-input:focus {
            background: var(--bg);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .workspace-actions {
            display: flex;
            gap: 0.75rem;
        }

        .workspace-content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
        }

        .content-area {
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            min-height: 400px;
        }

        .editor-area {
            outline: none;
            min-height: 400px;
            line-height: 1.8;
        }

        .editor-area[contenteditable="true"]:empty:before {
            content: attr(data-placeholder);
            color: var(--text-muted);
        }

        .workspace-toolbar {
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }

        .toolbar-group {
            display: flex;
            gap: 0.25rem;
            padding-right: 1rem;
            border-right: 1px solid var(--border);
        }

        .toolbar-group:last-child {
            border-right: none;
        }

        .toolbar-btn {
            min-width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid transparent;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 6px;
            transition: var(--transition);
        }

        .toolbar-btn:hover {
            background: var(--bg);
            color: var(--text);
        }

        .toolbar-select {
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            border: 2px solid var(--border);
            border-radius: 6px;
            background: var(--bg);
            color: var(--text);
            font-size: 0.875rem;
            cursor: pointer;
        }

        .color-input {
            width: 32px;
            height: 32px;
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--bg);
            color: var(--text);
            font-size: 1rem;
            outline: none;
            transition: var(--transition);
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .status-bar {
            background: var(--card-bg);
            border-top: 2px solid var(--border);
            padding: 0.75rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .modal-overlay.open {
            display: flex;
        }

        .modal {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            max-width: 500px;
            width: 90%;
        }

        .modal-header {
            padding: 2rem;
            border-bottom: 2px solid var(--border);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 2px solid var(--border);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-left: 4px solid var(--success);
            padding: 1rem 1.5rem;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg);
            z-index: 10000;
            animation: slideIn 0.3s ease;
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .app {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }

            .projects-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="app home-view" id="app">
        <aside class="sidebar" id="sidebar" style="display: none;">
            <div class="sidebar-header">
                <h1 class="sidebar-title">Note26</h1>
                <p class="sidebar-subtitle">Professional Workspace</p>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item" onclick="goHome(); return false;">
                    <i class="fas fa-home"></i>
                    Home
                </a>
                <div class="nav-item active">
                    <i class="fas fa-folder-open"></i>
                    <span id="sidebar-project-name">Current Project</span>
                </div>
            </nav>

            <div class="sidebar-footer">
                <strong>Note26 v1.0.0</strong><br>
                Â© 2025 Blacklink Education<br>
                Licensed under CC-BY-SA-4.0
            </div>
        </aside>

        <div class="main-content" id="home-page">
            <div class="home-page">
                <div class="home-header">
                    <h1 class="home-title">Welcome to Note26</h1>
                    <p class="home-subtitle">Your all-in-one productivity workspace</p>
                    <div class="home-actions">
                        <button class="btn btn-primary" onclick="openNewProjectModal()">
                            <i class="fas fa-plus"></i>
                            New Project
                        </button>
                        <button class="btn btn-secondary" onclick="toggleTheme()">
                            <i class="fas fa-moon"></i>
                            Toggle Theme
                        </button>
                    </div>
                </div>

                <div class="section-header">
                    <h2 class="section-title">Quick Actions</h2>
                </div>

                <div class="quick-actions">
                    <div class="quick-action-card" onclick="createQuickProject('presentation')">
                        <div class="quick-action-icon">
                            <i class="fas fa-presentation-screen"></i>
                        </div>
                        <div class="quick-action-title">Presentation</div>
                        <div class="quick-action-desc">Create slides and present</div>
                    </div>

                    <div class="quick-action-card" onclick="createQuickProject('document')">
                        <div class="quick-action-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="quick-action-title">Document</div>
                        <div class="quick-action-desc">Write and format text</div>
                    </div>

                    <div class="quick-action-card" onclick="createQuickProject('spreadsheet')">
                        <div class="quick-action-icon">
                            <i class="fas fa-table"></i>
                        </div>
                        <div class="quick-action-title">Spreadsheet</div>
                        <div class="quick-action-desc">Organize data in tables</div>
                    </div>

                    <div class="quick-action-card" onclick="createQuickProject('notes')">
                        <div class="quick-action-icon">
                            <i class="fas fa-sticky-note"></i>
                        </div>
                        <div class="quick-action-title">Quick Notes</div>
                        <div class="quick-action-desc">Capture ideas quickly</div>
                    </div>
                </div>

                <div class="section-header">
                    <h2 class="section-title">Recent Projects</h2>
                </div>

                <div class="projects-grid" id="projects-grid"></div>
            </div>
        </div>

        <div class="workspace" id="workspace" style="display: none;">
            <header class="workspace-header">
                <div class="workspace-title">
                    <button class="btn btn-icon btn-ghost" onclick="goHome()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <input type="text" class="project-name-input" id="project-name" placeholder="Project Name">
                </div>
                <div class="workspace-actions">
                    <button class="btn btn-secondary" onclick="saveProject()">
                        <i class="fas fa-save"></i>
                        Save
                    </button>
                    <button class="btn btn-primary" onclick="exportProject()">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                </div>
            </header>

            <div class="workspace-content" id="workspace-content"></div>

            <div class="status-bar">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span id="save-status">All changes saved</span>
                </div>
                <div>
                    <span id="word-count">0 words</span>
                    <span style="margin-left: 1rem;" id="char-count">0 characters</span>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="new-project-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Create New Project</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Project Name</label>
                    <input type="text" class="form-input" id="new-project-name" placeholder="My Awesome Project">
                </div>
                <div class="form-group">
                    <label class="form-label">Project Type</label>
                    <select class="form-input" id="new-project-type">
                        <option value="presentation">Presentation</option>
                        <option value="document">Document</option>
                        <option value="spreadsheet">Spreadsheet</option>
                        <option value="notes">Quick Notes</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeNewProjectModal()">Cancel</button>
                <button class="btn btn-primary" onclick="createProject()">Create Project</button>
            </div>
        </div>
    </div>

    <script>
        const state = {
            projects: [],
            currentProject: null,
            view: 'home'
        };

        function init() {
            loadProjects();
            renderProjects();

            const savedTheme = localStorage.getItem('note26_theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
        }

        function loadProjects() {
            const saved = localStorage.getItem('note26_projects');
            if (saved) {
                state.projects = JSON.parse(saved);
            }
        }

        function saveProjects() {
            localStorage.setItem('note26_projects', JSON.stringify(state.projects));
        }

        function renderProjects() {
            const container = document.getElementById('projects-grid');

            if (state.projects.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <i class="fas fa-folder-open"></i>
                        <h3>No projects yet</h3>
                        <p>Create your first project to get started</p>
                    </div>
                `;
                return;
            }

            const sortedProjects = [...state.projects].sort((a, b) => b.lastModified - a.lastModified);

            container.innerHTML = sortedProjects.map(project => {
                const icon = {
                    presentation: 'fa-presentation-screen',
                    document: 'fa-file-alt',
                    spreadsheet: 'fa-table',
                    notes: 'fa-sticky-note'
                }[project.type];

                const itemCount = {
                    presentation: project.data.slides?.length || 0,
                    document: 1,
                    spreadsheet: project.data.sheet?.length || 0,
                    notes: project.data.notes?.length || 0
                }[project.type];

                const itemLabel = {
                    presentation: 'slides',
                    document: 'document',
                    spreadsheet: 'rows',
                    notes: 'notes'
                }[project.type];

                return `
                    <div class="project-card" onclick="openProject('${project.id}')">
                        <div class="project-header">
                            <div class="project-icon">
                                <i class="fas ${icon}"></i>
                            </div>
                            <div class="project-actions">
                                <button class="btn btn-icon btn-ghost" onclick="duplicateProject('${project.id}'); event.stopPropagation();" title="Duplicate">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="btn btn-icon btn-ghost" onclick="deleteProject('${project.id}'); event.stopPropagation();" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="project-title">${project.name}</div>
                        <div class="project-meta">
                            <span><i class="fas fa-clock"></i> ${formatDate(project.lastModified)}</span>
                        </div>
                        <div class="project-stats">
                            <div class="stat">
                                <i class="fas fa-file"></i>
                                <span>${itemCount} ${itemLabel}</span>
                            </div>
                            <div class="stat">
                                <i class="fas fa-tag"></i>
                                <span>${project.type}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function openNewProjectModal() {
            document.getElementById('new-project-modal').classList.add('open');
            document.getElementById('new-project-name').focus();
        }

        function closeNewProjectModal() {
            document.getElementById('new-project-modal').classList.remove('open');
            document.getElementById('new-project-name').value = '';
        }

        function createProject() {
            const name = document.getElementById('new-project-name').value.trim();
            const type = document.getElementById('new-project-type').value;

            if (!name) {
                showToast('Please enter a project name', 'error');
                return;
            }

            const project = {
                id: Date.now().toString(),
                name: name,
                type: type,
                created: Date.now(),
                lastModified: Date.now(),
                data: initProjectData(type)
            };

            state.projects.push(project);
            saveProjects();
            closeNewProjectModal();
            openProject(project.id);
            showToast('Project created successfully');
        }

        function createQuickProject(type) {
            const names = {
                presentation: 'New Presentation',
                document: 'Untitled Document',
                spreadsheet: 'New Spreadsheet',
                notes: 'Quick Notes'
            };

            const project = {
                id: Date.now().toString(),
                name: names[type],
                type: type,
                created: Date.now(),
                lastModified: Date.now(),
                data: initProjectData(type)
            };

            state.projects.push(project);
            saveProjects();
            openProject(project.id);
        }

        function initProjectData(type) {
            switch (type) {
                case 'presentation':
                    return { slides: [{ title: 'Title Slide', content: '' }] };
                case 'document':
                    return { content: '' };
                case 'spreadsheet':
                    return { sheet: Array(10).fill(null).map(() => Array(5).fill('')) };
                case 'notes':
                    return { notes: [] };
                default:
                    return {};
            }
        }

        function openProject(id) {
            const project = state.projects.find(p => p.id === id);
            if (!project) return;

            state.currentProject = project;
            state.view = 'workspace';

            document.getElementById('app').classList.remove('home-view');
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('workspace').style.display = 'flex';
            document.getElementById('project-name').value = project.name;
            document.getElementById('sidebar-project-name').textContent = project.name;

            renderWorkspace(project);
        }

        function goHome() {
            if (state.currentProject) {
                saveCurrentProject();
            }

            state.currentProject = null;
            state.view = 'home';

            document.getElementById('app').classList.add('home-view');
            document.getElementById('sidebar').style.display = 'none';
            document.getElementById('home-page').style.display = 'block';
            document.getElementById('workspace').style.display = 'none';

            renderProjects();
        }

        function saveCurrentProject() {
            if (!state.currentProject) return;

            state.currentProject.lastModified = Date.now();
            state.currentProject.name = document.getElementById('project-name').value;

            const type = state.currentProject.type;
            if (type === 'document') {
                state.currentProject.data.content = document.getElementById('doc-editor')?.innerHTML || '';
            }

            saveProjects();
        }

        function saveProject() {
            saveCurrentProject();
            showToast('Project saved successfully');
        }

        function exportProject() {
            if (!state.currentProject) return;

            const data = JSON.stringify(state.currentProject, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${state.currentProject.name.replace(/\s+/g, '_')}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('Project exported successfully');
        }

        function deleteProject(id) {
            if (!confirm('Delete this project? This cannot be undone.')) return;

            state.projects = state.projects.filter(p => p.id !== id);
            saveProjects();
            renderProjects();
            showToast('Project deleted');
        }

        function duplicateProject(id) {
            const project = state.projects.find(p => p.id === id);
            if (!project) return;

            const duplicate = {
                ...JSON.parse(JSON.stringify(project)),
                id: Date.now().toString(),
                name: project.name + ' (Copy)',
                created: Date.now(),
                lastModified: Date.now()
            };

            state.projects.push(duplicate);
            saveProjects();
            renderProjects();
            showToast('Project duplicated');
        }

        function renderWorkspace(project) {
            const content = document.getElementById('workspace-content');

            switch (project.type) {
                case 'presentation':
                    renderPresentationWorkspace(content, project);
                    break;
                case 'document':
                    renderDocumentWorkspace(content, project);
                    break;
                case 'spreadsheet':
                    renderSpreadsheetWorkspace(content, project);
                    break;
                case 'notes':
                    renderNotesWorkspace(content, project);
                    break;
            }
        }

        function renderPresentationWorkspace(container, project) {
            container.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto;">
                    <div id="slides-container"></div>
                    <button class="btn btn-primary" onclick="addSlide()" style="margin-top: 2rem;">
                        <i class="fas fa-plus"></i>
                        Add Slide
                    </button>
                </div>
            `;
            renderSlides(project);
        }

        function renderSlides(project) {
            const container = document.getElementById('slides-container');
            const slides = project.data.slides || [];

            container.innerHTML = slides.map((slide, index) => `
                <div class="content-area" style="margin-bottom: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 700;">Slide ${index + 1}</h3>
                        <button class="btn btn-secondary btn-icon" onclick="deleteSlide(${index})" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <input type="text" class="form-input" value="${slide.title}" onchange="updateSlideTitle(${index}, this.value)" placeholder="Slide Title" style="margin-bottom: 1rem;">
                    <textarea class="form-input" onchange="updateSlideContent(${index}, this.value)" placeholder="Slide content..." style="min-height: 200px; resize: vertical;">${slide.content}</textarea>
                </div>
            `).join('');
        }

        function addSlide() {
            if (!state.currentProject) return;
            state.currentProject.data.slides.push({ title: '', content: '' });
            renderSlides(state.currentProject);
            saveCurrentProject();
        }

        function updateSlideTitle(index, title) {
            if (!state.currentProject) return;
            state.currentProject.data.slides[index].title = title;
            saveCurrentProject();
        }

        function updateSlideContent(index, content) {
            if (!state.currentProject) return;
            state.currentProject.data.slides[index].content = content;
            saveCurrentProject();
        }

        function deleteSlide(index) {
            if (!state.currentProject) return;
            if (state.currentProject.data.slides.length === 1) {
                showToast('Cannot delete the last slide', 'error');
                return;
            }
            if (confirm('Delete this slide?')) {
                state.currentProject.data.slides.splice(index, 1);
                renderSlides(state.currentProject);
                saveCurrentProject();
            }
        }

        function renderDocumentWorkspace(container, project) {
            container.innerHTML = `
                <div style="max-width: 900px; margin: 0 auto;">
                    <div class="workspace-toolbar">
                        <div class="toolbar-group">
                            <button class="toolbar-btn" onclick="formatDoc('bold')" title="Bold">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button class="toolbar-btn" onclick="formatDoc('italic')" title="Italic">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button class="toolbar-btn" onclick="formatDoc('underline')" title="Underline">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button class="toolbar-btn" onclick="formatDoc('strikeThrough')" title="Strikethrough">
                                <i class="fas fa-strikethrough"></i>
                            </button>
                        </div>
                        <div class="toolbar-group">
                            <input type="color" class="color-input" onchange="formatDoc('foreColor', this.value)" value="#0f172a" title="Text Color">
                            <input type="color" class="color-input" onchange="formatDoc('hiliteColor', this.value)" value="#ffff00" title="Highlight">
                        </div>
                        <div class="toolbar-group">
                            <button class="toolbar-btn" onclick="formatDoc('insertUnorderedList')" title="Bullet List">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button class="toolbar-btn" onclick="formatDoc('insertOrderedList')" title="Numbered List">
                                <i class="fas fa-list-ol"></i>
                            </button>
                        </div>
                        <div class="toolbar-group">
                            <button class="toolbar-btn" onclick="formatDoc('justifyLeft')" title="Align Left">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button class="toolbar-btn" onclick="formatDoc('justifyCenter')" title="Align Center">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button class="toolbar-btn" onclick="formatDoc('justifyRight')" title="Align Right">
                                <i class="fas fa-align-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="content-area">
                        <div class="editor-area" id="doc-editor" contenteditable="true" data-placeholder="Start writing your document..."></div>
                    </div>
                </div>
            `;

            setTimeout(() => {
                const editor = document.getElementById('doc-editor');
                if (editor) {
                    editor.innerHTML = project.data.content || '';
                    editor.addEventListener('input', () => {
                        updateWordCount();
                        saveCurrentProject();
                    });
                    updateWordCount();
                }
            }, 100);
        }

        function formatDoc(command, value = null) {
            document.execCommand(command, false, value);
            updateWordCount();
        }

        function updateWordCount() {
            const editor = document.getElementById('doc-editor');
            if (!editor) return;

            const text = editor.innerText.trim();
            const words = text.split(/\s+/).filter(word => word.length > 0);
            const chars = text.length;

            document.getElementById('word-count').textContent = `${words.length} words`;
            document.getElementById('char-count').textContent = `${chars} characters`;
        }

        function renderSpreadsheetWorkspace(container, project) {
            container.innerHTML = `
                <div style="height: 100%; display: flex; flex-direction: column;">
                    <div class="workspace-toolbar">
                        <button class="btn btn-primary" onclick="addRow()">
                            <i class="fas fa-plus"></i>
                            Add Row
                        </button>
                        <button class="btn btn-primary" onclick="addColumn()">
                            <i class="fas fa-plus"></i>
                            Add Column
                        </button>
                    </div>
                    <div class="content-area" style="flex: 1; overflow: auto; padding: 0;">
                        <table style="width: 100%; border-collapse: separate; border-spacing: 0;">
                            <thead>
                                <tr id="sheet-header">
                                    <th style="background: var(--bg-secondary); padding: 0.75rem; border: 1px solid var(--border); position: sticky; top: 0; z-index: 10;"></th>
                                </tr>
                            </thead>
                            <tbody id="sheet-body"></tbody>
                        </table>
                    </div>
                </div>
            `;

            renderSpreadsheet(project);
        }

        function renderSpreadsheet(project) {
            const sheet = project.data.sheet || [];
            const headerRow = document.getElementById('sheet-header');
            const body = document.getElementById('sheet-body');

            const colCount = sheet[0]?.length || 0;
            headerRow.innerHTML = '<th style="background: var(--bg-secondary); padding: 0.75rem; border: 1px solid var(--border); position: sticky; top: 0; z-index: 10;"></th>' +
                Array.from({ length: colCount }, (_, i) =>
                    `<th style="background: var(--bg-secondary); padding: 0.75rem; border: 1px solid var(--border); position: sticky; top: 0; z-index: 10; min-width: 120px;">${String.fromCharCode(65 + i)}</th>`
                ).join('');

            body.innerHTML = sheet.map((row, rowIndex) => `
                <tr>
                    <th style="background: var(--bg-secondary); padding: 0.75rem; border: 1px solid var(--border);">${rowIndex + 1}</th>
                    ${row.map((cell, colIndex) =>
                `<td contenteditable="true" onblur="updateCell(${rowIndex}, ${colIndex}, this.textContent)" style="background: var(--card-bg); padding: 0.75rem; border: 1px solid var(--border); min-width: 120px; outline: none;">${cell}</td>`
            ).join('')}
                </tr>
            `).join('');
        }

        function updateCell(row, col, value) {
            if (!state.currentProject) return;
            state.currentProject.data.sheet[row][col] = value;
            saveCurrentProject();
        }

        function addRow() {
            if (!state.currentProject) return;
            const colCount = state.currentProject.data.sheet[0]?.length || 5;
            state.currentProject.data.sheet.push(Array(colCount).fill(''));
            renderSpreadsheet(state.currentProject);
            saveCurrentProject();
        }

        function addColumn() {
            if (!state.currentProject) return;
            state.currentProject.data.sheet.forEach(row => row.push(''));
            renderSpreadsheet(state.currentProject);
            saveCurrentProject();
        }

        function renderNotesWorkspace(container, project) {
            container.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3 style="font-size: 1.5rem; font-weight: 700;">Quick Notes</h3>
                        <button class="btn btn-primary" onclick="addNote()">
                            <i class="fas fa-plus"></i>
                            New Note
                        </button>
                    </div>
                    <div id="notes-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;"></div>
                </div>
            `;

            renderNotes(project);
        }

        function renderNotes(project) {
            const container = document.getElementById('notes-grid');
            const notes = project.data.notes || [];

            if (notes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <i class="fas fa-sticky-note"></i>
                        <h3>No notes yet</h3>
                        <p>Create your first note</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = notes.map((note, index) => `
                <div class="content-area">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <input type="text" class="form-input" value="${note.title || 'Untitled'}" onchange="updateNoteTitle(${index}, this.value)" placeholder="Note Title" style="flex: 1; margin-right: 0.5rem;">
                        <button class="btn btn-icon btn-secondary" onclick="deleteNote(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <textarea class="form-input" onchange="updateNoteContent(${index}, this.value)" placeholder="Write your note..." style="min-height: 150px; resize: vertical;">${note.content || ''}</textarea>
                    <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem;">${formatDate(note.timestamp || Date.now())}</div>
                </div>
            `).join('');
        }

        function addNote() {
            if (!state.currentProject) return;
            state.currentProject.data.notes.unshift({
                title: 'New Note',
                content: '',
                timestamp: Date.now()
            });
            renderNotes(state.currentProject);
            saveCurrentProject();
        }

        function updateNoteTitle(index, title) {
            if (!state.currentProject) return;
            state.currentProject.data.notes[index].title = title;
            state.currentProject.data.notes[index].timestamp = Date.now();
            saveCurrentProject();
        }

        function updateNoteContent(index, content) {
            if (!state.currentProject) return;
            state.currentProject.data.notes[index].content = content;
            state.currentProject.data.notes[index].timestamp = Date.now();
            saveCurrentProject();
        }

        function deleteNote(index) {
            if (!state.currentProject) return;
            if (confirm('Delete this note?')) {
                state.currentProject.data.notes.splice(index, 1);
                renderNotes(state.currentProject);
                saveCurrentProject();
            }
        }

        function formatDate(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;

            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return `${Math.floor(diff / 60000)} min ago`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`;

            return date.toLocaleDateString();
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            localStorage.setItem('note26_theme', isDark ? 'dark' : 'light');
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<strong>${type === 'error' ? 'Error' : 'Success'}</strong><p>${message}</p>`;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('project-name')?.addEventListener('input', () => {
                if (state.currentProject) {
                    state.currentProject.name = document.getElementById('project-name').value;
                    document.getElementById('sidebar-project-name').textContent = state.currentProject.name;
                    saveCurrentProject();
                }
            });

            document.getElementById('new-project-name')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') createProject();
            });

            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    if (state.view === 'workspace') {
                        saveProject();
                    }
                }
            });
        });

        setInterval(() => {
            if (state.view === 'workspace' && state.currentProject) {
                saveCurrentProject();
            }
        }, 30000);

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>